set(target_name "processgroup")

set(target_dir
    "${CMAKE_SOURCE_DIR}/src/core/libprocessgroup"
)

set(target_util_dir
    "${target_dir}/util"
)

set(target_srcs 
    "${target_dir}/cgroup_map.cpp"
    "${target_dir}/processgroup.cpp"
    "${target_dir}/sched_policy.cpp"
    "${target_dir}/task_profiles.cpp"
)

set(target_util_srcs
    "${target_util_dir}/cgroup_controller.cpp"
    "${target_util_dir}/cgroup_descriptor.cpp"
    "${target_util_dir}/util.cpp"
)

set(libprocessgroup_headers
    "${target_dir}/include"
    CACHE STRING "" FORCE
)

set(libprocessgroup_util_headers
    "${target_util_dir}/include"
)

add_library("${target_name}_util" ${target_util_srcs})
target_include_directories("${target_name}_util" PUBLIC
    ${libcutils_headers}
    ${libbase_headers}
    ${libprocessgroup_headers}
    ${target_dir}
    ${libprocessgroup_util_headers}
    ${jsoncpp_headers}
)
add_library(${target_name} ${target_srcs})
target_include_directories(${target_name} PUBLIC
    ${libcutils_headers}
    ${libbase_headers}
    ${libprocessgroup_headers}
    ${target_dir}
    ${libprocessgroup_util_headers}
    ${jsoncpp_headers}
)
target_link_libraries(${target_name} ${target_name}_util jsoncpp_static gmock)