include("${CMAKE_SOURCE_DIR}/CMakeLists.e2fsprogs.txt")

set(libext2_support_dir
    "${CMAKE_SOURCE_DIR}/src/e2fsprogs/lib/support"
)

set(libext2_quota_srcs
    "${libext2_support_dir}/devname.c"
     "${libext2_support_dir}/dict.c"
     "${libext2_support_dir}/mkquota.c"
     "${libext2_support_dir}/parse_qtype.c"
      "${libext2_support_dir}/plausible.c"
      "${libext2_support_dir}/profile.c"
      "${libext2_support_dir}/profile_helpers.c"
      "${libext2_support_dir}/prof_err.c"
      "${libext2_support_dir}/quotaio.c"
      "${libext2_support_dir}/quotaio_tree.c"
      "${libext2_support_dir}/quotaio_v2.c"
)

set(libext2_support_srcs
    "${libext2_support_dir}/cstring.c"
)

set(libext2_profile_srcs
    "${libext2_support_dir}/prof_err.c"
    "${libext2_support_dir}/profile.c"
)

add_library(ext2_quota STATIC ${libext2_quota_srcs})
target_compile_options(ext2_quota PRIVATE ${e2fsprogs_cflags})
target_include_directories(ext2_quota PRIVATE
    ${libext2_support_dir}
    ${e2fsprogs_includes}
    ${libext2_headers}
)

add_library(ext2_support STATIC ${libext2_support_srcs})
target_compile_options(ext2_support PRIVATE ${e2fsprogs_cflags})
target_include_directories(ext2_support PRIVATE
    ${libext2_support_dir}
    ${e2fsprogs_includes}
    ${libext2_headers}
)

add_library(ext2_profile STATIC ${libext2_profile_srcs})
target_compile_options(ext2_profile PRIVATE ${e2fsprogs_cflags})
target_include_directories(ext2_profile PRIVATE
    ${libext2_support_dir}
    ${e2fsprogs_includes}
    ${libext2_headers}
)